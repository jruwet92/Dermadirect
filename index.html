<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dermatology Portal - Patient Assessment</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Loading Screen -->
        <div id="loadingScreen" class="loading">
            <div class="header">
                <h1>üîÑ Loading...</h1>
                <p>Initializing Dermatology Portal</p>
            </div>
            <div style="padding: 40px;">
                <p>Loading doctor credentials...</p>
            </div>
        </div>

        <!-- Login Screen -->
        <div id="loginScreen" class="login-screen hidden">
            <div class="header">
                <h1>üîí Restricted Access</h1>
                <p>Dermatology Portal - Patient Assessment</p>
            </div>
            <div style="padding: 40px;">
                <h2>Enter access code</h2>
                <div class="passcode-input">
                    <input type="password" id="passcode" placeholder="Access code" maxlength="20">
                </div>
                <button onclick="handleLogin()" class="submit-btn">Enter</button>
                <div id="loginError" class="alert alert-error hidden">
                    Incorrect access code. Please try again.
                </div>
            </div>
        </div>

        <!-- Main Application -->
        <div id="mainApp" class="hidden">
            <div class="header">
                <h1>ü©∫ Dermatology Portal</h1>
                <p>Dermatological Conditions Assessment System</p>
            </div>

            <div class="form-container">
                <div id="doctorInfo" class="doctor-info">
                    <h3>üë®‚Äç‚öïÔ∏è Authenticated Doctor</h3>
                    <p id="doctorDetails">Loading doctor information...</p>
                </div>

                <form id="patientForm">
                    <input type="hidden" id="doctorName" name="doctorName">
                    <input type="hidden" id="doctorEmail" name="doctorEmail">

                    <!-- Patient Information -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientId">Patient Identification *</label>
                            <input type="text" id="patientId" name="patientId" required placeholder="ID, SSN or other identifier">
                        </div>
                        <div class="form-group">
                            <label for="patientEmail">Patient Email *</label>
                            <input type="email" id="patientEmail" name="patientEmail" required placeholder="patient@example.com">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientAge">Patient Age *</label>
                            <input type="number" id="patientAge" name="patientAge" min="0" max="120" required>
                        </div>
                        <div class="form-group">
                            <label for="patientGender">Patient Gender *</label>
                            <select id="patientGender" name="patientGender" required>
                                <option value="">Select...</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <!-- Image Upload Section -->
                    <div class="form-group">
                        <label>Skin Condition Images (Max 3) *</label>
                        <div class="images-container" id="imagesContainer"></div>
                        <button type="button" id="addImageBtn" class="add-image-btn hidden">
                            ‚ûï Add another picture
                        </button>
                    </div>

                    <!-- Medical Questions -->
                    <div class="questions-section">
                        <h3>üìã Dermatological Anamnesis</h3>

                        <div class="question-group">
                            <label>1. How long has the lesion been present?</label>
                            <select name="lesionDuration" required>
                                <option value="">Select...</option>
                                <option value="less-1-week">Less than 1 week</option>
                                <option value="1-4-weeks">1 to 4 weeks</option>
                                <option value="1-3-months">1 to 3 months</option>
                                <option value="3-6-months">3 to 6 months</option>
                                <option value="more-6-months">More than 6 months</option>
                            </select>
                        </div>

                        <div class="question-group">
                            <label>2. Does the lesion present symptoms?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="symptoms" value="yes" required> Yes</label>
                                <label><input type="radio" name="symptoms" value="no" required> No</label>
                            </div>
                        </div>

                        <div class="question-group">
                            <label>3. If yes, which symptoms? (check all that apply)</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                                <label><input type="checkbox" name="symptomType" value="itching"> Itching</label>
                                <label><input type="checkbox" name="symptomType" value="pain"> Pain</label>
                                <label><input type="checkbox" name="symptomType" value="burning"> Burning</label>
                                <label><input type="checkbox" name="symptomType" value="scaling"> Scaling</label>
                                <label><input type="checkbox" name="symptomType" value="bleeding"> Bleeding</label>
                                <label><input type="checkbox" name="symptomType" value="discharge"> Discharge</label>
                            </div>
                        </div>

                        <div class="question-group">
                            <label>4. Has the lesion changed in appearance since it appeared?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="lesionChange" value="yes" required> Yes</label>
                                <label><input type="radio" name="lesionChange" value="no" required> No</label>
                            </div>
                        </div>

                        <div class="question-group">
                            <label>5. Family history of skin cancer or other dermatological conditions?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="familyHistory" value="yes" required> Yes</label>
                                <label><input type="radio" name="familyHistory" value="no" required> No</label>
                                <label><input type="radio" name="familyHistory" value="unknown" required> Don't know</label>
                            </div>
                        </div>

                        <div class="question-group">
                            <label>6. Frequent sun exposure or use of tanning beds?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="sunExposure" value="frequent" required> Frequent</label>
                                <label><input type="radio" name="sunExposure" value="occasional" required> Occasional</label>
                                <label><input type="radio" name="sunExposure" value="rare" required> Rare</label>
                            </div>
                        </div>

                        <div class="question-group">
                            <label>7. Previous treatments attempted?</label>
                            <textarea name="previousTreatments" rows="3" placeholder="Describe any medications, creams, or treatments previously used..."></textarea>
                        </div>

                        <div class="question-group">
                            <label>8. Additional medical observations</label>
                            <textarea name="additionalNotes" rows="4" placeholder="Describe other relevant observations about the case..."></textarea>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">üìß Send Report by Email</button>

                    <!-- Progress Bar -->
                    <div id="progressContainer" class="progress-container hidden">
                        <div class="progress-bar-wrapper">
                            <div id="progressBar" class="progress-bar" style="width: 0%;">0%</div>
                        </div>
                        <div id="progressStatus" class="progress-status">Preparing to send...</div>
                        <div id="retryInfo" class="retry-info hidden"></div>
                    </div>

                    <!-- Success Message -->
                    <div id="bottomSuccessMessage" class="bottom-alert hidden">
                        <strong>‚úÖ Votre demande a bien √©t√© transmise √† notre dermatologue</strong><br><br>
                        Le cas de votre patient sera revu sous 24h et l'analyse vous sera transmise par email.
                    </div>

                    <!-- Error Message -->
                    <div id="bottomErrorMessage" class="alert alert-error hidden" style="margin-top: 20px;"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/imageHandler.js"></script>
    <script src="js/api.js"></script>
    <script src="js/formHandler.js"></script>
</body>
</html>
